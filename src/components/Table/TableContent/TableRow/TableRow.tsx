import { Dispatch, SetStateAction, useState } from "react";
import * as S from "../../Table.style";
import { IProduct } from "../../../../types/types";
import { formatDate } from "../../../../scripts/formatDate";
import { TablePopup } from "./TablePopup/TablePopup";
import { useNavigate } from "react-router-dom";
import { Modal } from "../../../Modal/Modal";

interface IProps {
  elem: IProduct;
  index: number;
  toolTip: string;
  setToolTip: Dispatch<SetStateAction<string>>;
}

export const TableRow = ({ elem, index, toolTip, setToolTip }: IProps) => {
  const navigate = useNavigate();
  const [modal, setModal] = useState(false);  


  return (
    <S.TableRow>
      {modal && <Modal id={elem.id} setModal={setModal} />}
      <S.TableCeil>{Number(index) + 1}</S.TableCeil>
      <S.TableCeil>{elem.packsNumber}</S.TableCeil>
      <S.TableCeil>{elem.packageType}</S.TableCeil>
      <S.TableCeil>{formatDate(elem.createdAt)}</S.TableCeil>
      <S.TableCeil>{elem.isArchived ? "Архив" : "Активно"}</S.TableCeil>
      <S.TableCeilWithIcons>
        <S.TableIcon
          onClick={(event) => {
            event.stopPropagation();
            setToolTip(toolTip === elem.id ? "" : elem.id);
          }}
          width="18"
          height="19"
          viewBox="0 0 18 19"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M9 0.25C13.957 0.25 18 4.29297 18 9.25C18 14.2422 13.957 18.25 9 18.25C4.00781 18.25 0 14.2422 0 9.25C0 4.29297 4.00781 0.25 9 0.25ZM9 16.5625C13.0078 16.5625 16.3125 13.293 16.3125 9.25C16.3125 5.24219 13.0078 1.9375 9 1.9375C4.95703 1.9375 1.6875 5.24219 1.6875 9.25C1.6875 13.293 4.95703 16.5625 9 16.5625ZM9 12.0625C9.59766 12.0625 10.125 12.5547 10.125 13.1875C10.125 13.8203 9.59766 14.3125 9 14.3125C8.33203 14.3125 7.875 13.8203 7.875 13.1875C7.875 12.5547 8.36719 12.0625 9 12.0625ZM10.1602 4.75C11.5664 4.75 12.6562 5.83984 12.6211 7.21094C12.6211 8.05469 12.1641 8.86328 11.4258 9.32031L9.84375 10.3047V10.375C9.84375 10.832 9.45703 11.2188 9 11.2188C8.54297 11.2188 8.15625 10.832 8.15625 10.375V9.8125C8.15625 9.53125 8.29688 9.25 8.57812 9.07422L10.582 7.87891C10.8281 7.73828 10.9688 7.49219 10.9688 7.21094C10.9688 6.78906 10.582 6.4375 10.125 6.4375H8.33203C7.91016 6.4375 7.59375 6.78906 7.59375 7.21094C7.59375 7.66797 7.20703 8.05469 6.75 8.05469C6.29297 8.05469 5.90625 7.66797 5.90625 7.21094C5.90625 5.83984 6.99609 4.75 8.36719 4.75H10.1602Z"
            fill="#333333"
          />
        </S.TableIcon>
        {toolTip === elem.id && (
          <TablePopup setToolTip={setToolTip}>{elem.description}</TablePopup>
        )}
      </S.TableCeilWithIcons>
      <S.TableCeilWithIcons>
        
        {/* Иконка карандаш */}

        <S.TableIcon
          width="25"
          height="19"
          viewBox="0 0 25 19"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          onClick={() => navigate(`/edit/${elem.id}`)}
        >
          <path
            d="M15.5508 8.01953L7.35938 16.2109L6.16406 15.0156L6.30469 14.875H4.6875C4.37109 14.875 4.125 14.6289 4.125 14.3125V12.6953L3.98438 12.8359C3.80859 13.0117 3.70312 13.1875 3.63281 13.4336L2.82422 16.1758L5.56641 15.3672C5.77734 15.2969 5.98828 15.1914 6.16406 15.0156L7.35938 16.2109C7.00781 16.5625 6.55078 16.8438 6.05859 16.9844L1.80469 18.2148C1.52344 18.3203 1.20703 18.25 0.996094 18.0039C0.75 17.793 0.679688 17.4766 0.75 17.1953L2.01562 12.9414C2.15625 12.4492 2.4375 11.9922 2.78906 11.6406L10.9805 3.44922L15.5508 8.01953ZM18.0469 2.32422C18.9258 3.20312 18.9258 4.64453 18.0469 5.52344L16.3594 7.21094L11.7891 2.64062L13.4766 0.953125C14.3555 0.0742188 15.7969 0.0742188 16.6758 0.953125L18.0469 2.32422ZM50.4961 0.882812C50.6719 0.496094 51.0586 0.25 51.4805 0.25H55.7344C56.1562 0.25 56.543 0.496094 56.7188 0.882812L57 1.375H60.375C60.9727 1.375 61.5 1.90234 61.5 2.5C61.5 3.13281 60.9727 3.625 60.375 3.625H46.875C46.2422 3.625 45.75 3.13281 45.75 2.5C45.75 1.90234 46.2422 1.375 46.875 1.375H50.25L50.4961 0.882812ZM46.8398 4.75H60.375V16C60.375 17.2656 59.3555 18.25 58.125 18.25H49.0898C47.8594 18.25 46.8398 17.2656 46.8398 16V4.75ZM49.6523 7.5625V15.4375C49.6523 15.7539 49.9336 16 50.2148 16C50.5312 16 50.7773 15.7539 50.7773 15.4375V7.5625C50.7773 7.28125 50.5312 7 50.2148 7C49.9336 7 49.6523 7.28125 49.6523 7.5625ZM53.0273 7.5625V15.4375C53.0273 15.7539 53.3086 16 53.5898 16C53.9062 16 54.1875 15.7539 54.1875 15.4375V7.5625C54.1875 7.28125 53.9062 7 53.5898 7C53.3086 7 53.0273 7.28125 53.0273 7.5625ZM56.4375 7.5625V15.4375C56.4375 15.7539 56.6836 16 57 16C57.2812 16 57.5625 15.7539 57.5625 15.4375V7.5625C57.5625 7.28125 57.2812 7 57 7C56.6836 7 56.4375 7.28125 56.4375 7.5625Z"
            fill="#333333"
          />
        </S.TableIcon>

        {/* Иконка удаления */}

        <S.TableIcon
          width="26"
          height="19"
          viewBox="40 0 26 19"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          onClick={(event) => {
            event.stopPropagation();
            setModal(true);
          }}
        >
          <path
            d="M15.5508 8.01953L7.35938 16.2109L6.16406 15.0156L6.30469 14.875H4.6875C4.37109 14.875 4.125 14.6289 4.125 14.3125V12.6953L3.98438 12.8359C3.80859 13.0117 3.70312 13.1875 3.63281 13.4336L2.82422 16.1758L5.56641 15.3672C5.77734 15.2969 5.98828 15.1914 6.16406 15.0156L7.35938 16.2109C7.00781 16.5625 6.55078 16.8438 6.05859 16.9844L1.80469 18.2148C1.52344 18.3203 1.20703 18.25 0.996094 18.0039C0.75 17.793 0.679688 17.4766 0.75 17.1953L2.01562 12.9414C2.15625 12.4492 2.4375 11.9922 2.78906 11.6406L10.9805 3.44922L15.5508 8.01953ZM18.0469 2.32422C18.9258 3.20312 18.9258 4.64453 18.0469 5.52344L16.3594 7.21094L11.7891 2.64062L13.4766 0.953125C14.3555 0.0742188 15.7969 0.0742188 16.6758 0.953125L18.0469 2.32422ZM50.4961 0.882812C50.6719 0.496094 51.0586 0.25 51.4805 0.25H55.7344C56.1562 0.25 56.543 0.496094 56.7188 0.882812L57 1.375H60.375C60.9727 1.375 61.5 1.90234 61.5 2.5C61.5 3.13281 60.9727 3.625 60.375 3.625H46.875C46.2422 3.625 45.75 3.13281 45.75 2.5C45.75 1.90234 46.2422 1.375 46.875 1.375H50.25L50.4961 0.882812ZM46.8398 4.75H60.375V16C60.375 17.2656 59.3555 18.25 58.125 18.25H49.0898C47.8594 18.25 46.8398 17.2656 46.8398 16V4.75ZM49.6523 7.5625V15.4375C49.6523 15.7539 49.9336 16 50.2148 16C50.5312 16 50.7773 15.7539 50.7773 15.4375V7.5625C50.7773 7.28125 50.5312 7 50.2148 7C49.9336 7 49.6523 7.28125 49.6523 7.5625ZM53.0273 7.5625V15.4375C53.0273 15.7539 53.3086 16 53.5898 16C53.9062 16 54.1875 15.7539 54.1875 15.4375V7.5625C54.1875 7.28125 53.9062 7 53.5898 7C53.3086 7 53.0273 7.28125 53.0273 7.5625ZM56.4375 7.5625V15.4375C56.4375 15.7539 56.6836 16 57 16C57.2812 16 57.5625 15.7539 57.5625 15.4375V7.5625C57.5625 7.28125 57.2812 7 57 7C56.6836 7 56.4375 7.28125 56.4375 7.5625Z"
            fill="#333333"
          />
        </S.TableIcon>
      </S.TableCeilWithIcons>
    </S.TableRow>
  );
};
